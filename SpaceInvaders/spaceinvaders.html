<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Insert title here</title>
<script src="http://code.jquery.com/jquery-3.1.1.js"></script>
<script src="http://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

<style type="text/css">
.stage {
	width: 820px;
	height: 600px;
	background-image: url("imagens/espaco.jpg");
	background-color: black;
	position: absolute;
}

.invasor {
	width: 30px;
	height: 30px;
	background-color: blue;
	position: absolute;
	display: block;
	background-color: blue;
}
</style>


<script type="text/javascript">
	//Definição dos Invasores

	var distanciaHorizontalInvasores = 30;
	var distanciaVerticalInvasores = 10;

	var tamanhoInvasores = 30;
	var invasoresLinha = 5;
	var invasoresColuna = 8;
	var invasores = [];

	var direcaoHorizontal = 1;// 1 move para a direita e -1 move para a esquerda;
	var posicaoVertical = 0; // 

	function iniciarInvasores() {
		var n = 0;
		var div;
		for (i = 0; i < invasoresColuna; i++) {
			for (j = 0; j < invasoresLinha; j++) {
				div = document.createElement("div");
				div.setAttribute("id", "invasor" + n);
				div.setAttribute("name", "invasor");
				div.setAttribute("class", "invasor");
				div.setAttribute("x", i
						* (distanciaHorizontalInvasores + tamanhoInvasores));
				div.setAttribute("y", j
						* (distanciaVerticalInvasores + tamanhoInvasores));

				div.setAttribute("style", "left: " + i
						* (distanciaHorizontalInvasores + tamanhoInvasores)
						+ "px; top:" + j
						* (distanciaVerticalInvasores + tamanhoInvasores)
						+ "px");
				$("#divStage").append(div);
				n++;
			}
		}
		setInterval(moverInvasores, 1000);
	}

	function moverInvasores() {

		var direcao = direcaoHorizontal;
		var posicao = posicaoVertical;
		var x;
		var y;
		var quantidadeInimigos = document.getElementsByName("invasor").length;

		for (i = 0; i < quantidadeInimigos; i++) {

			x = parseInt(document.getElementsByName("invasor")[i]
					.getAttribute("x"));

			y = parseInt(document.getElementsByName("invasor")[i]
					.getAttribute("y"));

			if (posicao === 1) {
				y += tamanhoInvasores + distanciaVerticalInvasores;
				posicaoVertical = 2;
			} else {
				if (direcao === 1) {
					x += (tamanhoInvasores + distanciaHorizontalInvasores);
				} else {
					x -= (tamanhoInvasores + distanciaHorizontalInvasores);
				}
			}
			document.getElementsByName("invasor")[i].setAttribute("x", x);
			document.getElementsByName("invasor")[i].style.left = document
					.getElementsByName("invasor")[i].getAttribute("x")
					+ "px";

			document.getElementsByName("invasor")[i].setAttribute("y", y);
			document.getElementsByName("invasor")[i].style.top = document
					.getElementsByName("invasor")[i].getAttribute("y")
					+ "px";

			if (x + (tamanhoInvasores + distanciaHorizontalInvasores) > 800) {
				if (direcao === direcaoHorizontal && posicaoVertical === 0) {
					direcaoHorizontal *= -1;
					posicaoVertical = 1;
				} else {
					if (posicaoVertical === 2) {
						posicaoVertical = 0;
					}
				}
			}

			if (x - (tamanhoInvasores + distanciaHorizontalInvasores) < 0) {
				if (direcao === direcaoHorizontal && posicaoVertical === 0) {
					direcaoHorizontal *= -1;
					posicaoVertical = 1;
				} else {
					if (posicaoVertical === 2) {
						posicaoVertical = 0;
					}
				}
			}
		}
	}

	function removeInimigo(left, top) {
		var quantidadeInimigos = document.getElementsByName("invasor").length;
		var x, y;
		for (i = 0; i < quantidadeInimigos; i++) {
			x = parseInt(document.getElementsByName("invasor")[i].getAttribute("x"));
			y = parseInt(document.getElementsByName("invasor")[i].getAttribute("y"));
			if ( x >= left && x <= (left + tamanhoInvasores)
					&&  y>= top && y <= (top + tamanhoInvasores)){
				console.log("tiro");
				//document.getElementsByName("invasor")[i].hide("explode",500);
				$("#"+document.getElementsByName("invasor")[i].getAttribute("id")).hide("explode",300);
				document.getElementsByName("invasor")[i].remove();
				return;
			}
		}

	}
	

</script>

</head>
<body>
	<div class="stage" id="divStage">
		<button onclick="iniciarInvasores()">Iniciar Game</button>
		
	</div>
</body>
</html>